<style>
    #target {
        overflow: auto;
    }

    #target2 {
        overflow: auto;
    }

    textarea {
        resize: vertical;
    }

    /* Rating Star Widgets Style */
    .rating-stars ul {
        list-style-type: none;
        padding: 0;

        -moz-user-select: none;
        -webkit-user-select: none;
    }

    .rating-stars ul>li.star {
        display: inline-block;

    }

    /* Idle State of the stars */
    .rating-stars ul>li.star>i.fa {
        font-size: 2.5em;
        /* Change the size of the stars */
        color: #ffffff;
        /* Color on idle state */
    }

    /* Hover state of the stars */
    .rating-stars ul>li.star.hover>i.fa {
        color: #FFCC36;
    }

    /* Selected state of the stars */
    .rating-stars ul>li.star.selected>i.fa {
        color: #FF912C;
    }

    #sortable {
        list-style-type: none;
        margin: 0;
        padding: 0;
        width: 60%;
    }

    #sortable li {
        margin: 0 3px 3px 3px;
        padding: 0.4em;
        padding-left: 1.5em;
        font-size: 1.4em;
        height: 18px;
    }

    #sortable li span {
        position: absolute;
        margin-left: -1.3em;
    }
</style>

<body>
    <!--Panel Tool-->
    <div class="center-align panelTool">
        <!-- à¸ºBasic -->
        <div class="noselect source sourceHeader activeSource" type="basic" style="background-color:#FF9D00;">
            Operator</div>
        <div id="source" class="connectedSource source sourcePanel activeSource noselect" type="basic"
            ondrop="drop(event)" ondragover="allowDrop(event)">
            <div type="element" event="start" source="basic" draggable="true" ondragstart="drag(event)" id="start"
            onclick="modal_input(this)">
                <svg width="210" height="90">
                    <rect x="5" y="5" width="200" height="80" rx="40"
                        style="fill: #FC5972;stroke: #000000;stroke-width: 5px;"></rect>
                    <text text-anchor="middle" x="105" y="45" alignment-baseline="central"
                        style="font-size:25px;" class="test">Click to insert</text>

                </svg>
            </div>
            <div type="element" event="process" source="basic" draggable="true" ondragstart="drag(event)" id="process">
                <svg width="210" height="90">
                    <rect x="5" y="5" width="200" height="80" rx="10"
                        style="fill: #FC5972;stroke: #000000;stroke-width: 5px;"></rect>
                    <text text-anchor="middle" x="105" y="45" alignment-baseline="central"
                        style="font-size:25px;">Process</text>
                </svg>
            </div>

        </div>
        <!-- Type Process -->
        <div class="noselect source sourceHeader" type="process" style="display: none;background-color:#FF9D00;">
            Test Topic
        </div>
        <!-- <div id="source" class="connectedSource source noselect sourcePanel" type="process" style="display: none;">
            //
        </div> -->

        <!-- Question Area -->
        <div id="target" class="center-align connectedSource noselect targetPanel ui-widget-content"
            style="width: 43%;">

        </div>
        <div id="question" class="center-align connectedSource noselect targetPanel ui-widget-content"
            style="width: 30%;margin-left: 45%;" id="div1" ondrop="drop(event)" ondragover="allowDrop(event)">
            <div style="padding: 0px 20px 20px 20px;">
                <p style="text-align: left;font-size: 18px;font-weight: bold;">Question Name</p>
                <input id="questionInput" type="text" style="background-color: white;" />
                <p style="text-align: left;font-size: 18px;font-weight: bold;">Hint</p>
                <textarea id="hintInput" style="background-color: white;height: 240px;"></textarea>
                <p style="text-align: left;font-size: 18px;font-weight: bold;">Difficult</p>
                <!-- Rating Stars Box -->
                <section class='rating-widget'>
                    <div class='rating-stars' style="text-align: left;">
                        <ul id='stars'>
                            <li class='star' title='Poor' data-value='1'>
                                <i class='fa fa-star fa-fw'></i>
                            </li>
                            <li class='star' title='Fair' data-value='2'>
                                <i class='fa fa-star fa-fw'></i>
                            </li>
                            <li class='star' title='Good' data-value='3'>
                                <i class='fa fa-star fa-fw'></i>
                            </li>
                            <li class='star' title='Excellent' data-value='4'>
                                <i class='fa fa-star fa-fw'></i>
                            </li>
                            <li class='star' title='WOW!!!' data-value='5'>
                                <i class='fa fa-star fa-fw'></i>
                            </li>
                        </ul>
                    </div>

                    <div class='success-box'>
                        <div class='clearfix'></div>
                        <div class='text-message'></div>
                        <div class='clearfix'></div>
                    </div>
                </section>
            </div>
        </div>
    </div>
    <!--Menu Icon-->
    <ul class="tabs">
        <li style="height: 80px;" class="tab">
            <div id="saveButton" class="canClick jellyButton button-tool">
                <div class="save-icon"></div>
            </div>
        </li>
        <li style="height: 90px;" class="tab">
            <div id="cancelButton" class="canClick jellyButton button-tool">
                <div class="cancel-icon"></div>
            </div>
        </li>

    </ul>
</body>

<div id="modal-input" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            Input text
        </div>
        <input type="text" id="input-test" value="">
    </div>
    <div class="modal-footer">

        <button class="modal-button button-element" style="float:right" onclick="save_text()">Save</button>
    </div>
</div>

<script>

    $(document).ready(function () {

        /* 1. Visualizing things on Hover - See next part for action on click */
        $('#stars li').on('mouseover', function () {
            var onStar = parseInt($(this).data('value'), 10); // The star currently mouse on

            // Now highlight all the stars that's not after the current hovered star
            $(this).parent().children('li.star').each(function (e) {
                if (e < onStar) {
                    $(this).addClass('hover');
                }
                else {
                    $(this).removeClass('hover');
                }
            });

        }).on('mouseout', function () {
            $(this).parent().children('li.star').each(function (e) {
                $(this).removeClass('hover');
            });
        });


        /* 2. Action to perform on click */
        $('#stars li').on('click', function () {
            var onStar = parseInt($(this).data('value'), 10); // The star currently selected
            var stars = $(this).parent().children('li.star');

            for (i = 0; i < stars.length; i++) {
                $(stars[i]).removeClass('selected');
            }

            for (i = 0; i < onStar; i++) {
                $(stars[i]).addClass('selected');
            }

            // JUST RESPONSE (Not needed)
            var ratingValue = parseInt($('#stars li.selected').last().data('value'), 10);

            console.log(ratingValue);
        });

    });

    $(function () {
        
        $("#source,#target").sortable({
            connectWith: ".connectedSource",
            cancel: ".ui-state-disabled",
            activate: function (event, ui) {
                $(ui.item[0]).addClass("play_jelly");
                playSoundEx('pop');

            },
            deactivate: function (event, ui) {
                playSoundEx('drop');
            },
            update: function (event, ui) {
                let targetId = $(event.target).attr('id');
                let targetSource = $(event.target).attr('type');
                let uiSource = $(ui.item[0]).attr('source');
                let uiId = $('#start_input').attr('id');
                if (targetId == 'source' && (targetSource != uiSource)) {
                    $(ui.item[0]).detach().appendTo('#source[type="' + uiSource + '"]');
                }
            }
        });

        //
        // update arrow between element
        //
        $("#target").sortable({
            cancel: ".ui-state-disabled .arrow",
            items: "div:not(.arrow)",
            update: function (event, ui) {
                updateFlowchart();
            }
        });
        //
        // end of update arrow function
        //

    });
    function modal_input(obj) {
        console.log("Obj", obj)
        document.getElementById('modal-input').style.display='block';
        console.log("click", $(this).parent().attr("id"));
        var ids = obj.id
        console.log("Par", $(ids).parent().parent().attr("id"))
        if ($(ids).parent() == $(ids).parent()) {
            console.log("Par", $(ids).parent())
        }
    }

    function save_text(){
        document.getElementById('modal-input').style.display='none';
        $(".test").empty()
        console.log("clicksss", $("#input-test").val());
        $(".test").append($("#input-test").val())
    }
</script>